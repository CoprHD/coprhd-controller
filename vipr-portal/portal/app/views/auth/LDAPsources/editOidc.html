%{
  titleKey = 'LDAPsources.' + (authnProvider?.id ? 'edit' : 'create') + '.title';
  descriptionKey = 'LDAPsources.description';
  image = '/public/img/assets/AuthProvider.png';
}%
#{extends 'main.html' /}
#{set navSelected: ['nav.security', 'nav.providers'] /}
#{set 'title'}&{titleKey}#{/set}
#{set editMode:authnProvider?.id ? true : false/}
#{ifErrors}
  #{set errors: true/}
#{/ifErrors}
#{else}
  #{set errors: flash.error ? true : false/}
#{/else}


#{set 'moreScripts'}
  <!--
  ~ /*
  ~  * Copyright (c) 2016 EMC Corporation
  ~  * All Rights Reserved
  ~  */
  -->
<script type="text/javascript">
    function submitForm(){
        $('#authProviderForm').submit();
    }

    $(document).ready( function() {
        $("#authnProvider_mode")
            .change( function() {
                window.location.href = "@{create(authSource)}?authsource="+this.value;
        });
    });
</script>

#{/set}


<div class="container">
	#{Form.header titleKey:titleKey, descriptionKey:descriptionKey, image:image /}
	
	#{alerts/}
	
#{form @saveOidc(), id:'authProviderForm', class:'form form-horizontal', autocomplete:"off"}

  <fieldset>
    #{field 'authnProvider.name'}
     %{
        field.required = true
      }%
      #{Form.inputTextControlGroup field:field /}
    #{/field}
    
    #{field 'authnProvider.mode'}
     %{
        field.options = authSourceTypeList
        field.required = true
        field.cssClass = 'span3'
      }%
      #{Form.selectOneControlGroup field:field /}
    #{/field}
    
    #{field 'authnProvider.description'}
     %{
        field.required = false
      }%
      #{Form.inputTextControlGroup field:field /}
    #{/field}
    
    
    #{field 'authnProvider.oidcBaseUrl'}
     %{
        field.required = true
        field.helpTextKey = field.name + '.description'
      }%
      #{Form.textAreaControlGroup field:field /}
    #{/field}
    
    #{field 'authnProvider.domains'}
     %{
        field.required = true
        field.value = domainString
         
        field.helpTextKey = field.name + '.description'
      }%
      #{Form.textAreaControlGroup field:field /}
    #{/field}
    
    #{field 'authnProvider.disable'}
        %{
          field.cssClass = 'span0'
          field.required = false
        }%
      #{Form.booleanCheckBoxControlGroup field:field/}
    #{/field}

    #{if authnProvider?.id}
      #{field 'authnProvider.id'}
        <input type="hidden" name="${field.name}" value="${field.value}">
      #{/field}
    #{/if}

  </fieldset>

    #{Form.buttonBar}
    #{Form.button name:'button.save', class:'primary', icon:'ok-sign', size:'large', action:'submitForm();'/}
    #{Form.button name:'button.cancel', icon:'trash', size:'large', href:@list()/}
    #{/Form.buttonBar}
#{/form}

</div>
